#!/usr/bin/env bash

# DEPENDENCIES
# -------------------------------------------------------------------------------------------------
# - bash 4

# Imports
# -------------------------------------------------------------------------------------------------

source <(curl -s "https://raw.githubusercontent.com/delucca/shell-functions/1.0.1/modules/feedback.sh")
source <(curl -s "https://raw.githubusercontent.com/delucca/shell-functions/1.0.1/modules/validation.sh")

# Entrypoint
# -------------------------------------------------------------------------------------------------

function main {
  validate_requirements

  if [ "${CODESPACES}" = "true" ]; then
    setup_codespaces
  else
    setup_local
  fi
}

# Validate requirements
# -------------------------------------------------------------------------------------------------

function validate_requirements {
  validate_bash_dependency
}

# Setup codespaces
# -------------------------------------------------------------------------------------------------

function setup_codespaces {
  log_title "SETUP CODESPACES"

  bootstrap_codespaces
}

function bootstrap_codespaces {
  log_title "BOOTSTRAP"

  curl -s "https://raw.githubusercontent.com/delucca/lazyscripts/1.0.2/bin/bootstrap-codespaces" -o "/tmp/bootstrap-codespaces"
  chmod +x "/tmp/bootstrap-codespaces"
  /tmp/bootstrap-codespaces
}

# Setup local
# -------------------------------------------------------------------------------------------------

function setup_code_env {
  log_title "SETUP LOCAL"

  bootstrap_local
}

function bootstrap_local {
  log_title "BOOTSTRAP"

  curl -s "https://raw.githubusercontent.com/delucca/lazyscripts/1.0.2/bin/bootstrap-code-env" -o "/tmp/bootstrap-code-env"
  chmod +x "/tmp/bootstrap-code-env"
  /tmp/bootstrap-code-env --dotfiles

}

# Execute
# -------------------------------------------------------------------------------------------------

main
